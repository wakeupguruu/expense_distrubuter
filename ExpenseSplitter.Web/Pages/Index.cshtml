@page
@model IndexModel
@{
    ViewData["Title"] = "Expense Splitter";
}

<div class="container py-4">
    <h1 class="mb-3">Expense Splitter</h1>
    @if (TempData["Msg"] is string msg)
    {
        <div class="alert alert-success">@msg</div>
    }
    @if (!ViewContext.ModelState.IsValid)
    {
        <div class="alert alert-danger">
            <ul class="mb-0">
                @foreach (var e in ViewContext.ModelState.Values.SelectMany(v => v.Errors))
                {
                    <li>@e.ErrorMessage</li>
                }
            </ul>
        </div>
    }

    <div class="card mb-3">
        <div class="card-body">
            <form method="post" asp-page-handler="SetGroupName" class="row g-2 align-items-center">
                <div class="col-auto">
                    <label class="col-form-label fw-semibold">Group Name</label>
                </div>
                <div class="col-auto">
                    <input asp-for="GroupName" class="form-control" placeholder="e.g. Goa Trip" />
                </div>
                <div class="col-auto">
                    <button class="btn btn-primary" type="submit">Save</button>
                </div>
            </form>
        </div>
    </div>

    <div class="card mb-3">
        <div class="card-header">Members</div>
        <div class="card-body">
            <form method="post" asp-page-handler="AddMember" class="row g-2">
                <div class="col-auto">
                    <input asp-for="NewMemberName" class="form-control" placeholder="Add member name" />
                </div>
                <div class="col-auto">
                    <button class="btn btn-success" type="submit">Add</button>
                </div>
            </form>
            <ul class="mt-3">
                @foreach (var m in Model.Members)
                {
                    <li>@m</li>
                }
            </ul>
        </div>
    </div>

    <div class="d-flex gap-2">
        <a asp-page="/Expenses" class="btn btn-outline-primary">Add & View Expenses</a>
        <a asp-page="/Balances" class="btn btn-outline-secondary">Balances & Settlement</a>
    </div>
</div>
